<header class="header">
  <div class="container">
    <div class="header-content">
      <!-- Logo -->
      <div class="logo">
        <svg class="logo-icon" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="#e53e3e">
          <path d="M6 2L3 6v13a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4H6zm3 0v4h6V2H9z" />
        </svg>
        <h1 class="logo-main">
          <span class="ttb">TTB</span><span class="highlight">STORE</span>
        </h1>
      </div>

      <!-- Navigation -->
      <nav class="nav">
        <ul class="nav-list">
          <li><a href="#" class="nav-link">{{ 'header.nav.home' | translate }}</a></li>
          <li><a routerLink="/products" routerLinkActive="active" class="nav-link">{{ 'header.nav.products' | translate }}</a></li>
         <!-- <li><a href="#" class="nav-link">{{ 'header.nav.categories' | translate }}</a></li>-->
          <li><a href="support" class="nav-link">{{ 'header.nav.support' | translate }}</a></li>
          <li><a href="contact" class="nav-link">{{ 'header.nav.contact' | translate }}</a></li>
        </ul>
      </nav>

      <!-- Search Bar -->
      <div class="search-bar">
        <input type="text" [(ngModel)]="keyword" (ngModelChange)="onKeywordChange($event)"
               [placeholder]="'header.search_placeholder' | translate"
               class="search-input">
        <button class="search-btn" (click)="onSearchSubmit()">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
        </button>
      </div>

      <!-- User Actions -->
      <div class="user-actions">
        <!-- Notification -->
        <li class="nav-item notification-icon" (click)="toggleNotificationPopover()">
          <span class="icon-bell-wrapper">
            <span class="icon-bell">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="white" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                   style="background-color: white; border-radius: 50%; padding: 4px;">
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
              </svg>
            </span>
            <span *ngIf="unreadCount > 0" class="badge">{{ unreadCount }}</span>
          </span>
          <div *ngIf="showPopover" class="notification-popover">
            <div *ngFor="let noti of notifications" class="notification-item" [class.unread]="!noti.read" (click)="viewNotificationDetail(noti.id)">
              <strong>{{ noti.title }}</strong>
              <p>{{ noti.content }}</p>
              <small>{{ noti.createdAt | date: 'short' }}</small>
              <button *ngIf="!noti.read" (click)="markAsRead(noti.id); $event.stopPropagation()">
                {{ 'header.markAsRead' | translate }}
              </button>
            </div>
          </div>
        </li>

        <!-- Nếu đã đăng nhập -->
        <ng-container *ngIf="userResponse; else loginButton">
          <button class="action-btn" [ngbPopover]="popoverContent" #popover="ngbPopover" triggers="click" [placement]="'bottom'">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <span class="action-text">{{ userResponse.fullname }}</span>
          </button>

          <ng-template #popoverContent>
            <div class="popover-list">
              <a class="popover-item" (click)="handleItemClick(0, popover)">
                {{ 'header.account' | translate }}
              </a>
              <a class="popover-item" (click)="handleItemClick(2, popover)">
                {{ 'header.history' | translate }}
              </a>
              <a class="popover-item" (click)="handleItemClick(3, popover)">
                {{ 'header.logout' | translate }}
              </a>
            </div>
          </ng-template>
        </ng-container>

        <!-- Nếu chưa đăng nhập -->
        <ng-template #loginButton>
          <button class="action-btn" routerLink="/login" routerLinkActive="active">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <span class="action-text">{{ 'header.login' | translate }}</span>
          </button>
        </ng-template>

        <!-- Cart Button -->
        <button class="action-btn cart-btn" routerLink="/orders" routerLinkActive="active"
                [routerLinkActiveOptions]="{ exact: true }" (click)="onNavLinkClick(2)">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17M17 13v6a2 2 0 01-2 2H9a2 2 0 01-2-2v-6">
            </path>
          </svg>
          <span class="cart-count">{{ cartCount }}</span>
        </button>
      </div>
    </div>
  </div>
</header>
