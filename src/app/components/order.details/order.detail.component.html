

<div class="order-detail">
  <div class="container">
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
      <a href="#" class="breadcrumb-link">{{ 'orderDetail.breadcrumb.home' | translate }}</a>
      <span class="breadcrumb-separator">></span>
      <a href="#" class="breadcrumb-link">{{ 'orderDetail.breadcrumb.history' | translate }}</a>
      <span class="breadcrumb-separator">></span>
      <span class="breadcrumb-current">{{ 'orderDetail.breadcrumb.detail' | translate }}</span>
    </nav>

    <!-- Order Header -->
    <div class="order-header">
      <div class="order-info">
        <h1>{{ 'orderDetail.title' | translate }}</h1>
        <div class="order-meta">
          <span class="order-id">{{ 'orderDetail.orderId' | translate }}: {{ orderResponse.id }}</span>
          <span class="order-date">{{ 'orderDetail.orderDate' | translate }}: {{ orderResponse.order_date| date:'yyyy年MM月dd日 HH:mm' }}</span>
          <span class="order-status" [class]="'status-' + orderResponse.status">
            {{ getStatusLabel(orderResponse.status) }}
          </span>
        </div>
      </div>
      <div class="order-actions">
        <button class="action-btn secondary" (click)="printOrder()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6,9 6,2 18,2 18,9"></polyline>
            <path d="M6 18H4a2 2 0 01-2-2v-5a2 2 0 012-2h16a2 2 0 012 2v5a2 2 0 01-2 2h-2"></path>
            <polyline points="6,14 6,22 18,22 18,14"></polyline>
          </svg>
          {{ 'orderDetail.print' | translate }}
        </button>
        <button class="action-btn secondary" (click)="downloadInvoice()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"></path>
          </svg>
          {{ 'orderDetail.downloadInvoice' | translate }}
        </button>
        <!--<button class="action-btn primary" *ngIf="order.trackingNumber" (click)="trackOrder()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path>
          </svg>
          配送状況を確認
        </button>-->
      </div>
    </div>

    <div class="order-content">
      <!-- Order Timeline -->
      <!--<div class="order-section">
        <h2>注文状況</h2>
        <div class="order-timeline">
          <div class="timeline-item" *ngFor="let item of order.timeline" [class.completed]="item.completed">
            <div class="timeline-dot"></div>
            <div class="timeline-content">
              <h4>{{ item.status }}</h4>
              <p>{{ item.description }}</p>
              <span class="timeline-date">{{ item.date | date:'MM月dd日 HH:mm' }}</span>
            </div>
          </div>
        </div>
      </div>-->

      <!-- Order Items -->
      <div class="order-section">
        <h2>{{ 'orderDetail.itemsTitle' | translate }}</h2>
        <div class="order-items">
          <div class="order-item" *ngFor="let item of orderResponse.order_details">
            <div class="item-image">
              <img [src]="item.product.thumbnail" [alt]="item.product.name">
            </div>
            <div class="item-details">
             
              <h3>{{ item.product.name }}</h3>
              <div class="item-sku">{{ 'orderDetail.productCode' | translate }}: {{ item.id }}</div>  
              <div class="item-options" *ngIf="item.color">
                <span *ngIf="item.color" class="option">{{ 'orderDetail.color' | translate }}: {{ item.color }}: {{ item.color }}</span>
               
              </div>
            </div>
            <div class="item-quantity">
              <span class="quantity-label">{{ 'orderDetail.quantity' | translate }}</span>
              <span class="quantity-value">{{ item.number_of_products }}</span>
            </div>
            <div class="item-price">
              <div class="unit-price">{{ 'orderDetail.unitPrice' | translate }}: ¥{{ item.price | number }}</div>
              <div class="total-price">{{ 'orderDetail.subtotal' | translate }}: ¥{{ (item.price * item.number_of_products) | number }}</div>
            </div>
            <div class="item-actions">
              <button class="action-btn secondary small" (click)="reorderItem(item.id)">
                {{ 'orderDetail.reorder' | translate }}
              </button>
              <button class="action-btn secondary small" *ngIf="orderResponse.status === 'delivered'" (click)="reviewItem(item.id)">
                {{ 'orderDetail.writeReview' | translate }}
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Shipping & Billing -->
      <div class="address-section">
        <div class="address-card">
          <h3>{{ 'orderDetail.shippingAddress' | translate }}</h3>
          <div class="address-content">
            <div class="address-name">{{ orderResponse.fullname }}</div>
            <div class="address-details">
            
              <p>〒{{orderResponse.address }}</p>
           
              <p>{{ 'orderDetail.phone' | translate }}: {{ orderResponse.phone_number }}</p>
            </div>
          </div>
        </div>

        <div class="address-card" *ngIf="orderResponse.address">
          <h3>{{ 'orderDetail.billingAddress' | translate }}</h3>
          <div class="address-content">
            <div class="address-name">{{ orderResponse.fullname }}</div>
            <div class="address-details">
             
              <p>〒{{ orderResponse.address }}</p>
             
              <p>{{ 'orderDetail.phone' | translate }}: {{ orderResponse.phone_number}}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Payment & Shipping Info -->
      <div class="info-section">
        <div class="info-card">
          <h3>{{ 'orderDetail.paymentInfo' | translate }}</h3>
          <div class="payment-info">
            <div class="payment-method">
              <span class="label">支払い方法:</span>
              <span class="value">{{ orderResponse.payment_method }}</span>
            </div>
            <!--<div class="payment-status">
              <span class="label">支払い状況:</span>
              <span class="value status-completed">支払い完了</span>
            </div>-->
          </div>
        </div>

        <!--<div class="info-card">
          <h3>配送情報</h3>
          <div class="shipping-info">
            <div class="shipping-method">
              <span class="label">配送方法:</span>
              <span class="value">標準配送（無料）</span>
            </div>
            <div class="tracking-number" *ngIf="order.trackingNumber">
              <span class="label">追跡番号:</span>
              <span class="value tracking">{{ order.trackingNumber }}</span>
            </div>
            <div class="estimated-delivery" *ngIf="order.estimatedDelivery">
              <span class="label">お届け予定:</span>
              <span class="value">{{ order.estimatedDelivery | date:'MM月dd日' }}</span>
            </div>
            <div class="actual-delivery" *ngIf="order.actualDelivery">
              <span class="label">配送完了日:</span>
              <span class="value">{{ order.actualDelivery | date:'MM月dd日 HH:mm' }}</span>
            </div>
          </div>
        </div>-->
      </div>

      <!-- Order Summary -->
      <div class="order-section">
        <h2>{{ 'orderDetail.totalTitle' | translate }}</h2>
        <div class="order-summary">
          <!--<div class="summary-row">
            <span>商品小計</span>
            <span>¥{{ order.subtotal | number }}</span>
          </div>
          <div class="summary-row">
            <span>消費税</span>
            <span>¥{{ order.tax | number }}</span>
          </div>
          <div class="summary-row">
            <span>送料</span>
            <span>{{ order.shippingFee === 0 ? '無料' : '¥' + (order.shippingFee | number) }}</span>
          </div>-->
          <div class="summary-row total">
            <span>{{ 'orderDetail.totalAmount' | translate }}</span>
            <span>¥{{ orderResponse.total_money | number }}</span>
          </div>
        </div>
      </div>

      <!-- Order Notes -->
      <div class="order-section" *ngIf="orderResponse.note">
        <h2>{{ 'orderDetail.noteTitle' | translate }}</h2>
        <div class="order-notes">
          <p>{{ orderResponse.note }}</p>
        </div>
      </div>

      <!-- Support Actions -->
      <div class="support-actions">
        <h3>{{ 'orderDetail.needHelp' | translate }}</h3>
        <div class="support-buttons">
          <button class="support-btn" (click)="contactSupport()">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"></path>
            </svg>
            {{ 'orderDetail.contactSupport' | translate }}
          </button>
          <button class="support-btn" (click)="reportProblem()">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"></path>
              <line x1="12" y1="9" x2="12" y2="13"></line>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
            {{ 'orderDetail.reportProblem' | translate }}
          </button>
          <button class="support-btn" *ngIf="canCancel()" (click)="cancelOrder()">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="15" y1="9" x2="9" y2="15"></line>
              <line x1="9" y1="9" x2="15" y2="15"></line>
            </svg>
            {{ 'orderDetail.cancelOrder' | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>